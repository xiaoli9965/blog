(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{476:function(t,s,a){"use strict";a.r(s);var e=a(34),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[a("strong",[t._v("å‡ ç§å®ç°åˆ†å¸ƒå¼é”çš„æ–¹å¼")])]),t._v(" "),a("ul",[a("li",[t._v("åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”ï¼›")]),t._v(" "),a("li",[t._v("ğŸŒåŸºäºç¼“å­˜ï¼ˆRedisç­‰ï¼‰å®ç°åˆ†å¸ƒå¼é”ï¼›")]),t._v(" "),a("li",[t._v("ğŸ’¥åŸºäºZookeeperå®ç°åˆ†å¸ƒå¼é”ï¼›")])])]),t._v(" "),a("h2",{attrs:{id:"_1-å‡ ä¸ªæ ¸å¿ƒè¦ç´ "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-å‡ ä¸ªæ ¸å¿ƒè¦ç´ "}},[t._v("#")]),t._v(" 1. å‡ ä¸ªæ ¸å¿ƒè¦ç´ ")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("ul",[a("li",[t._v("åŠ é”")]),t._v(" "),a("li",[t._v("è§£é”")]),t._v(" "),a("li",[t._v("é”è¶…æ—¶")]),t._v(" "),a("li",[t._v("ä¿è¯åŸå­æ€§")])])]),t._v(" "),a("h2",{attrs:{id:"_3-åŸºäºzookeeperå®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-åŸºäºzookeeperå®ç°"}},[t._v("#")]),t._v(" 3. åŸºäºZookeeperå®ç°")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("è¿™æ˜¯é›…è™ç ”ç©¶å‘˜è®¾è®¡ Zookeeper çš„åˆè¡·ã€‚åˆ©ç”¨ Zookeeper çš„ä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼Œå¯ä»¥è½»æ¾å®ç°åˆ†å¸ƒå¼é”ã€‚\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("åŸºäºä¸´æ—¶æœ‰åºèŠ‚ç‚¹å®ç°")]),t._v(" "),a("p",[a("strong",[t._v("ä¸´æ—¶æœ‰åºèŠ‚ç‚¹çš„å‡ ä¸ªç‰¹æ€§")])]),t._v(" "),a("ul",[a("li",[t._v("äº§ç”ŸèŠ‚ç‚¹æ˜¯æœ‰åºçš„")]),t._v(" "),a("li",[t._v("å®¢æˆ·ç«¯æ–­å¼€è¿æ¥ä¼šè‡ªåŠ¨åˆ é™¤å½“å‰èŠ‚ç‚¹")])])]),t._v(" "),a("p",[t._v("å‚è€ƒ "),a("a",{attrs:{href:"https://mp.weixin.qq.com/s/u8QDlrDj3Rl1YjY4TyKMCA",target:"_blank",rel:"noopener noreferrer"}},[t._v(" ç¨‹åºå‘˜å°ç° åšå®¢ "),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"_3-1-è·å–é”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-è·å–é”"}},[t._v("#")]),t._v(" 3.1. è·å–é”")]),t._v(" "),a("ul",[a("li",[t._v("1.å½“å®¢æˆ·ç«¯æƒ³è¦è·å–é”æ—¶,éœ€è¦åœ¨ZKæŸä¸ªèŠ‚ç‚¹("),a("code",[t._v("æš‚å®šPL")]),t._v(")ä¸‹åˆ›å»ºä¸€ä¸ª"),a("strong",[t._v("ä¸´æ—¶é¡ºåºèŠ‚ç‚¹")]),t._v(" "),a("code",[t._v("lock1")])]),t._v(" "),a("li",[t._v("2.ç„¶åè·å–PLèŠ‚ç‚¹ä¸‹æ‰€æœ‰å­èŠ‚ç‚¹åˆ¤æ–­è‡ªå·±åˆ›å»ºçš„æ˜¯å¦æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹")]),t._v(" "),a("li",[t._v("3.å¦‚æœè‡ªå·±æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹,ä»£è¡¨è·å–é”æˆåŠŸ")]),t._v(" "),a("li",[t._v("4.å¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å°±è®¾ç½®ä¸€ä¸ª"),a("code",[t._v("Watcher")]),t._v(",ç›‘å¬å‰ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ "),a("code",[t._v("æŠ¢é”å¤±è´¥,è¿›å…¥ç­‰å¾…")])])]),t._v(" "),a("blockquote",[a("p",[t._v("è·å–é”å¤±è´¥è®¾ç½®Watcherç›‘å¬å‰ä¸€ä¸ªèŠ‚ç‚¹è¿™æ ·å°±ä¼šå½¢æˆä¸€ä¸ªFIFOé˜Ÿåˆ—,ç±»ä¼¼AQS")])]),t._v(" "),a("h3",{attrs:{id:"_3-2-é‡Šæ”¾é”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-é‡Šæ”¾é”"}},[t._v("#")]),t._v(" 3.2. é‡Šæ”¾é”")]),t._v(" "),a("ul",[a("li",[t._v("å½“é”ç”¨å®Œæ—¶,å®¢æˆ·ç«¯æ‰§è¡Œåˆ é™¤å‘½ä»¤,åˆ é™¤è‡ªèº«åˆ›å»ºçš„é”\n"),a("ul",[a("li",[t._v("å¦‚æœåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å®¢æˆ·ç«¯å´©æºƒä¼šè‡ªåŠ¨é‡Šæ”¾é”(ZKä¸´æ—¶èŠ‚ç‚¹ç‰¹æ€§,å®¢æˆ·ç«¯æ–­å¼€ä¼šè‡ªåŠ¨æ¸…é™¤æ‰€åˆ›å»ºèŠ‚ç‚¹)")])])]),t._v(" "),a("li",[t._v("å®¢æˆ·ç«¯1åˆ é™¤æ‰èŠ‚ç‚¹å,"),a("code",[t._v("å®¢æˆ·ç«¯2")]),t._v("é€šè¿‡Wactheræ„ŸçŸ¥"),a("code",[t._v("Lock1")]),t._v("è¢«åˆ é™¤")]),t._v(" "),a("li",[t._v("å®¢æˆ·ç«¯2è·å–åˆ°äº†é”,å¼€å§‹æ‰§è¡Œé€»è¾‘")])]),t._v(" "),a("h3",{attrs:{id:"_3-3-zookeeper-å’Œ-redis-åˆ†å¸ƒå¼é”çš„æ¯”è¾ƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-zookeeper-å’Œ-redis-åˆ†å¸ƒå¼é”çš„æ¯”è¾ƒ"}},[t._v("#")]),t._v(" 3.3. Zookeeper å’Œ Redis åˆ†å¸ƒå¼é”çš„æ¯”è¾ƒ")]),t._v(" "),a("p",[t._v(":::\n"),a("img",{attrs:{src:"http://md.yike.link/20200711202456_QwnuDs_Screenshot.jpeg",alt:"Zookeeper å’Œ Redis åˆ†å¸ƒå¼é”çš„æ¯”è¾ƒ"}}),t._v("\n:::")]),t._v(" "),a("h2",{attrs:{id:"_4-åŸºäºrediså®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-åŸºäºrediså®ç°"}},[t._v("#")]),t._v(" 4. åŸºäºRediså®ç°")]),t._v(" "),a("p",[t._v("å‚è€ƒ "),a("a",{attrs:{href:"https://mp.weixin.qq.com/s/WigpT0yjD2kCwtx91paT0g",target:"_blank",rel:"noopener noreferrer"}},[t._v("ç¨‹åºå‘˜å°ç° åšå®¢"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("è·å–é”")]),t._v(" "),a("ul",[a("li",[t._v("ä½¿ç”¨ "),a("code",[t._v("setï¼ˆkeyï¼Œ1ï¼Œ30ï¼ŒNXï¼‰")]),t._v(" æ¥è®¾ç½®ä¸€æŠŠé”")]),t._v(" "),a("li",[t._v("å¦‚æœè¿”å›okå°±ä»£è¡¨è·å–åˆ°äº†é”, å¦‚æœä¸æ˜¯å°±åœ¨ä¸€å®šæ—¶é—´å†…é‡è¯•å‡ æ¬¡è·å–é”")])]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" threadId "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsetï¼ˆkeyï¼ŒthreadId ï¼Œ"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("ï¼ŒNXï¼‰\n")])])])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("é‡Šæ”¾é”")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" luaScript "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"if redis.call('get', KEYS[1]) == ARGV[1] then return redis.call('del', KEYS[1]) else return 0 end\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nredisClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("eval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("luaScript "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collections")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("singletonList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collections")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("singletonList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("threadId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);