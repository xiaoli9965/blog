(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{459:function(t,a,s){"use strict";s.r(a);var n=s(34),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("ul",[s("li",[t._v("å‚è€ƒ "),s("a",{attrs:{href:"https://mp.weixin.qq.com/s/DZkGRTan2qSzJoDAx7QJag",target:"_blank",rel:"noopener noreferrer"}},[t._v("ç¨‹åºå‘˜å°ç° åšå®¢"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("å‚è€ƒ "),s("a",{attrs:{href:"https://www.cnblogs.com/null-qige/p/9481900.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("åšå®¢å›­ åšå®¢"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"_1-volatile-æ˜¯ä»€ä¹ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-volatile-æ˜¯ä»€ä¹ˆ"}},[t._v("#")]),t._v(" 1. volatile æ˜¯ä»€ä¹ˆ")]),t._v(" "),s("p",[s("strong",[t._v("volatileæ˜¯Javaè™šæ‹Ÿæœºè½»é‡çº§çš„åŒæ­¥æœºåˆ¶.")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("ä¸‰å¤§ç‰¹æ€§")]),t._v(" "),s("ul",[s("li",[t._v("å¯è§æ€§\n"),s("ul",[s("li",[t._v("ä¿è¯å˜é‡åœ¨çº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§ã€‚å¯è§æ€§çš„ä¿è¯æ˜¯åŸºäºCPUçš„å†…å­˜å±éšœæŒ‡ä»¤ï¼Œè¢«JSR-133æŠ½è±¡ä¸ºhappens-beforeåŸåˆ™ã€‚")])])]),t._v(" "),s("li",[t._v("ç¦æ­¢æŒ‡ä»¤é‡æ’åº\n"),s("ul",[s("li",[t._v("é˜»æ­¢ç¼–è¯‘æ—¶å’Œè¿è¡Œæ—¶çš„æŒ‡ä»¤é‡æ’ã€‚ç¼–è¯‘æ—¶JVMç¼–è¯‘å™¨éµå¾ªå†…å­˜å±éšœçš„çº¦æŸï¼Œè¿è¡Œæ—¶ä¾é CPUå±éšœæŒ‡ä»¤æ¥é˜»æ­¢é‡æ’ã€‚")])])])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("æŒ‡ä»¤é‡æ’åº")]),t._v(" "),s("p",[t._v("ä¸ºäº†æé«˜æ€§èƒ½,"),s("code",[t._v("ç¼–è¯‘å™¨")]),t._v("å’Œ"),s("code",[t._v("å¤„ç†å™¨")]),t._v("å¸¸å¸¸ä¼šå¯¹ä»£ç è¿›è¡ŒæŒ‡ä»¤é‡æ’åº.(ä»£ç é¡ºåºæ”¹å˜),"),s("br"),t._v("\nåœ¨ä¸æ”¹å˜ç¨‹åºæ‰§è¡Œç»“æœçš„å‰æä¸‹,å°½å¯èƒ½çš„ä¿è¯é«˜æ•ˆçš„æ‰§è¡Œ.")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://md.yike.link/20200709212159_IMChTj_Screenshot.jpeg",alt:"æŒ‡ä»¤é‡æ’åº"}})]),t._v(" "),s("p",[t._v("é‡æ’åºçš„å¥½å¤„: å¯ä»¥æé«˜å¤„ç†å™¨çš„å¤„ç†é€Ÿåº¦\né‡æ’åºçš„åå¤„:  åœ¨å¹¶å‘æ‰§è¡Œæ—¶å¹¶ä¸èƒ½ä¿è¯é‡æ’åºåä»£ç çš„æ­£å¸¸æ‰§è¡Œ")])]),t._v(" "),s("h2",{attrs:{id:"_2-jmm-javaçº¿ç¨‹å†…å­˜æ¨¡å‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-jmm-javaçº¿ç¨‹å†…å­˜æ¨¡å‹"}},[t._v("#")]),t._v(" 2. JMM (Javaçº¿ç¨‹å†…å­˜æ¨¡å‹)")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://md.yike.link/20200709210726_2Mp7Qc_Screenshot.jpeg",alt:"JMM"}}),t._v(" "),s("img",{attrs:{src:"http://md.yike.link/20200709210832_JkSuPl_Screenshot.jpeg",alt:"JMM"}})]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[t._v("å…±äº«å˜é‡å­˜å‚¨åœ¨ä¸»å†…å­˜(Main Memory)ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç§æœ‰çš„æœ¬åœ°å†…å­˜ï¼ˆLocal Memoryï¼‰ï¼Œ"),s("br"),t._v("\næœ¬åœ°å†…å­˜ä¿å­˜äº†è¢«è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„ä¸»å†…å­˜çš„å‰¯æœ¬æ‹·è´ï¼Œçº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("è¿™é‡Œéœ€è¦è§£é‡Šå‡ ä¸ªæ¦‚å¿µï¼š")])]),t._v(" "),s("p",[t._v("1.ä¸»å†…å­˜ï¼ˆMain Memoryï¼‰\nä¸»å†…å­˜å¯ä»¥ç®€å•ç†è§£ä¸ºè®¡ç®—æœºå½“ä¸­çš„å†…å­˜ï¼Œä½†åˆä¸å®Œå…¨ç­‰åŒã€‚ä¸»å†…å­˜è¢«æ‰€æœ‰çš„çº¿ç¨‹æ‰€å…±äº«ï¼Œå¯¹äºä¸€ä¸ªå…±äº«å˜é‡ï¼ˆæ¯”å¦‚é™æ€å˜é‡ï¼Œæˆ–æ˜¯å †å†…å­˜ä¸­çš„å®ä¾‹ï¼‰æ¥è¯´ï¼Œä¸»å†…å­˜å½“ä¸­å­˜å‚¨äº†å®ƒçš„â€œæœ¬å°Šâ€ã€‚")]),t._v(" "),s("p",[t._v("2.å·¥ä½œå†…å­˜ï¼ˆWorking Memoryï¼‰\nå·¥ä½œå†…å­˜å¯ä»¥ç®€å•ç†è§£ä¸ºè®¡ç®—æœºå½“ä¸­çš„CPUé«˜é€Ÿç¼“å­˜ï¼Œä½†åˆä¸å®Œå…¨ç­‰åŒã€‚æ¯ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œå¯¹äºä¸€ä¸ªå…±äº«å˜é‡æ¥è¯´ï¼Œå·¥ä½œå†…å­˜å½“ä¸­å­˜å‚¨äº†å®ƒçš„â€œå‰¯æœ¬â€ã€‚")]),t._v(" "),s("p",[t._v("çº¿ç¨‹å¯¹å…±äº«å˜é‡çš„æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜è¿›è¡Œï¼Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ã€‚ä¸åŒçº¿ç¨‹ä¹‹é—´ä¹Ÿæ— æ³•è®¿é—®å½¼æ­¤çš„å·¥ä½œå†…å­˜ï¼Œå˜é‡å€¼çš„ä¼ é€’åªèƒ½é€šè¿‡ä¸»å†…å­˜æ¥è¿›è¡Œã€‚")]),t._v(" "),s("h3",{attrs:{id:"_2-1-å†…å­˜å±éšœ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-å†…å­˜å±éšœ"}},[t._v("#")]),t._v(" 2.1. å†…å­˜å±éšœ")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("å†…å­˜äº¤äº’æ“ä½œ")]),t._v(" "),s("p",[t._v("å†…å­˜äº¤äº’æ“ä½œæœ‰8ç§ï¼Œè™šæ‹Ÿæœºå®ç°å¿…é¡»ä¿è¯æ¯ä¸€ä¸ªæ“ä½œéƒ½æ˜¯åŸå­çš„ï¼Œä¸å¯åœ¨åˆ†çš„ï¼ˆå¯¹äºdoubleå’Œlongç±»å‹çš„å˜é‡æ¥è¯´ï¼Œloadã€storeã€readå’Œwriteæ“ä½œåœ¨æŸäº›å¹³å°ä¸Šå…è®¸ä¾‹å¤–ï¼‰")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("æ“ä½œ")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("é€‚ç”¨å†…å­˜")]),t._v(" "),s("th",[t._v("è§£é‡Š")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("strong",[t._v("lockï¼ˆé”å®šï¼‰")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("ä¸»å†…å­˜")]),t._v(" "),s("td",[t._v("æŠŠä¸€ä¸ªå˜é‡æ ‡è¯†ä¸ºçº¿ç¨‹ç‹¬å çŠ¶æ€")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("unlockï¼ˆè§£é”ï¼‰")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("ä¸»å†…å­˜")]),t._v(" "),s("td",[t._v("å®ƒæŠŠä¸€ä¸ªå¤„äºé”å®šçŠ¶æ€çš„å˜é‡é‡Šæ”¾å‡ºæ¥ï¼Œé‡Šæ”¾åçš„å˜é‡æ‰å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹é”å®š")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("readï¼ˆè¯»å–ï¼‰")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("ä¸»å†…å­˜")]),t._v(" "),s("td",[t._v("å®ƒæŠŠä¸€ä¸ªå˜é‡çš„å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„loadåŠ¨ä½œä½¿ç”¨")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("loadï¼ˆè½½å…¥ï¼‰")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("å·¥ä½œå†…å­˜")]),t._v(" "),s("td",[t._v("å®ƒæŠŠreadæ“ä½œä»ä¸»å­˜ä¸­å˜é‡æ”¾å…¥å·¥ä½œå†…å­˜ä¸­")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("useï¼ˆä½¿ç”¨ï¼‰")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("å·¥ä½œå†…å­˜")]),t._v(" "),s("td",[t._v("å®ƒæŠŠreadæ“ä½œä»ä¸»å­˜ä¸­å˜é‡æ”¾å…¥å·¥ä½œå†…å­˜ä¸­")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("assignï¼ˆèµ‹å€¼ï¼‰")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("å·¥ä½œå†…å­˜")]),t._v(" "),s("td",[t._v("å®ƒæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“ä¸­æ¥å—åˆ°çš„å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("storeï¼ˆå­˜å‚¨ï¼‰")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("ä¸»å†…å­˜")]),t._v(" "),s("td",[t._v("å®ƒæŠŠä¸€ä¸ªä»å·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿åç»­çš„writeä½¿ç”¨")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("writeï¼ˆå†™å…¥ï¼‰")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("ä¸»å†…å­˜")]),t._v(" "),s("td",[t._v("å®ƒæŠŠstoreæ“ä½œä»å·¥ä½œå†…å­˜ä¸­å¾—åˆ°çš„å˜é‡çš„å€¼æ”¾å…¥ä¸»å†…å­˜çš„å˜é‡ä¸­")])])])]),t._v(" "),s("p",[s("strong",[t._v("JMMå¯¹è¿™å…«ç§æŒ‡ä»¤çš„ä½¿ç”¨ï¼Œåˆ¶å®šäº†å¦‚ä¸‹è§„åˆ™ï¼š")])]),t._v(" "),s("ul",[s("li",[t._v("ä¸å…è®¸readå’Œloadã€storeå’Œwriteæ“ä½œä¹‹ä¸€å•ç‹¬å‡ºç°ã€‚å³ä½¿ç”¨äº†readå¿…é¡»loadï¼Œä½¿ç”¨äº†storeå¿…é¡»write")]),t._v(" "),s("li",[t._v("ä¸å…è®¸çº¿ç¨‹ä¸¢å¼ƒä»–æœ€è¿‘çš„assignæ“ä½œï¼Œå³å·¥ä½œå˜é‡çš„æ•°æ®æ”¹å˜äº†ä¹‹åï¼Œå¿…é¡»å‘ŠçŸ¥ä¸»å­˜")]),t._v(" "),s("li",[t._v("ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹å°†æ²¡æœ‰assignçš„æ•°æ®ä»å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜")]),t._v(" "),s("li",[t._v("ä¸€ä¸ªæ–°çš„å˜é‡å¿…é¡»åœ¨ä¸»å†…å­˜ä¸­è¯ç”Ÿï¼Œä¸å…è®¸å·¥ä½œå†…å­˜ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœªè¢«åˆå§‹åŒ–çš„å˜é‡ã€‚å°±æ˜¯æ€¼å˜é‡å®æ–½useã€storeæ“ä½œä¹‹å‰ï¼Œå¿…é¡»ç»è¿‡assignå’Œloadæ“ä½œ")]),t._v(" "),s("li",[t._v("ä¸€ä¸ªå˜é‡åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¯¹å…¶è¿›è¡Œlockã€‚å¤šæ¬¡lockåï¼Œå¿…é¡»æ‰§è¡Œç›¸åŒæ¬¡æ•°çš„unlockæ‰èƒ½è§£é”")]),t._v(" "),s("li",[t._v("å¦‚æœå¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œlockæ“ä½œï¼Œä¼šæ¸…ç©ºæ‰€æœ‰å·¥ä½œå†…å­˜ä¸­æ­¤å˜é‡çš„å€¼ï¼Œåœ¨æ‰§è¡Œå¼•æ“ä½¿ç”¨è¿™ä¸ªå˜é‡å‰ï¼Œå¿…é¡»é‡æ–°loadæˆ–assignæ“ä½œåˆå§‹åŒ–å˜é‡çš„å€¼")]),t._v(" "),s("li",[t._v("å¦‚æœä¸€ä¸ªå˜é‡æ²¡æœ‰è¢«lockï¼Œå°±ä¸èƒ½å¯¹å…¶è¿›è¡Œunlockæ“ä½œã€‚ä¹Ÿä¸èƒ½unlockä¸€ä¸ªè¢«å…¶ä»–çº¿ç¨‹é”ä½çš„å˜é‡")]),t._v(" "),s("li",[t._v("å¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œunlockæ“ä½œä¹‹å‰ï¼Œå¿…é¡»æŠŠæ­¤å˜é‡åŒæ­¥å›ä¸»å†…å­˜")])])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("å†…å­˜å±éšœå…±åˆ†ä¸ºå››ç§ç±»å‹")]),t._v(" "),s("p",[s("strong",[t._v("LoadLoadå±éšœï¼š")]),t._v("\næŠ½è±¡åœºæ™¯ï¼šLoad1; LoadLoad; Load2\nLoad1 å’Œ Load2 ä»£è¡¨ä¸¤æ¡è¯»å–æŒ‡ä»¤ã€‚åœ¨Load2è¦è¯»å–çš„æ•°æ®è¢«è®¿é—®å‰ï¼Œä¿è¯Load1è¦è¯»å–çš„æ•°æ®è¢«è¯»å–å®Œæ¯•ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("StoreStoreå±éšœï¼š")]),t._v("\næŠ½è±¡åœºæ™¯ï¼šStore1; StoreStore; Store2\nStore1 å’Œ Store2ä»£è¡¨ä¸¤æ¡å†™å…¥æŒ‡ä»¤ã€‚åœ¨Store2å†™å…¥æ‰§è¡Œå‰ï¼Œä¿è¯Store1çš„å†™å…¥æ“ä½œå¯¹å…¶å®ƒå¤„ç†å™¨å¯è§")]),t._v(" "),s("p",[s("strong",[t._v("LoadStoreå±éšœï¼š")]),t._v("\næŠ½è±¡åœºæ™¯ï¼šLoad1; LoadStore; Store2\nåœ¨Store2è¢«å†™å…¥å‰ï¼Œä¿è¯Load1è¦è¯»å–çš„æ•°æ®è¢«è¯»å–å®Œæ¯•ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("StoreLoadå±éšœï¼š")]),t._v("\næŠ½è±¡åœºæ™¯ï¼šStore1; StoreLoad; Load2\nåœ¨Load2è¯»å–æ“ä½œæ‰§è¡Œå‰ï¼Œä¿è¯Store1çš„å†™å…¥å¯¹æ‰€æœ‰å¤„ç†å™¨å¯è§ã€‚StoreLoadå±éšœçš„å¼€é”€æ˜¯å››ç§å±éšœä¸­æœ€å¤§çš„ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"_3-happens-before-å…ˆè¡Œå‘ç”Ÿè§„åˆ™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-happens-before-å…ˆè¡Œå‘ç”Ÿè§„åˆ™"}},[t._v("#")]),t._v(" 3. happens-before (å…ˆè¡Œå‘ç”Ÿè§„åˆ™)")]),t._v(" "),s("blockquote",[s("p",[t._v("JDK5å¼•å…¥Happens-beforeè§„åˆ™, ä¸€ä¸ªçº¿ç¨‹çš„æ“ä½œå¦‚æœè¦è¢«å…¶ä»–çº¿ç¨‹å¯è§,é‚£ä¹ˆä¸€å®šè¦å­˜åœ¨Hanppens-beforeå…³ç³»;\nhappens-before åŸåˆ™ä¸»è¦æ˜¯ä¸ºè§£å†³çº¿ç¨‹ç›´æ¥çš„å¯è§æ€§")])]),t._v(" "),s("p",[s("strong",[t._v("ç®€å•ç†è§£: å‰ä¸€ä¸ªæ“ä½œçš„ç»“æœéœ€è¦å¯¹åç»­çš„æ“ä½œå¯è§;")])]),t._v(" "),s("h3",{attrs:{id:"_3-1-happens-beforeè§„åˆ™ğŸ”¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-happens-beforeè§„åˆ™ğŸ”¥"}},[t._v("#")]),t._v(" 3.1. happens-beforeè§„åˆ™ğŸ”¥")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ç¨‹åºæ¬¡åºè§„åˆ™ï¼ˆProgram Order Ruleï¼‰")]),t._v("ï¼šåœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼Œç¨‹åºçš„æ‰§è¡Œè§„åˆ™è·Ÿç¨‹åºçš„ä¹¦å†™è§„åˆ™æ˜¯ä¸€è‡´çš„ï¼Œä»ä¸Šå¾€ä¸‹æ‰§è¡Œã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ç®¡ç¨‹é”å®šè§„åˆ™ï¼ˆMonitor Lock Ruleï¼‰")]),t._v("ï¼šä¸€ä¸ªUnlockçš„æ“ä½œè‚¯å®šå…ˆäºä¸‹ä¸€æ¬¡Lockçš„æ“ä½œã€‚è¿™é‡Œå¿…é¡»æ˜¯åŒä¸€ä¸ªé”ã€‚åŒç†æˆ‘ä»¬å¯ä»¥è®¤ä¸ºåœ¨synchronizedåŒæ­¥åŒä¸€ä¸ªé”çš„æ—¶å€™ï¼Œé”å†…å…ˆè¡Œæ‰§è¡Œçš„ä»£ç ï¼Œå¯¹åç»­åŒæ­¥è¯¥é”çš„çº¿ç¨‹æ¥è¯´æ˜¯å®Œå…¨å¯è§çš„ã€‚\nvolatileå˜é‡è§„åˆ™ï¼ˆvolatile Variable Ruleï¼‰ï¼šå¯¹åŒä¸€ä¸ªvolatileçš„å˜é‡ï¼Œå…ˆè¡Œå‘ç”Ÿçš„å†™æ“ä½œï¼Œè‚¯å®šæ—©äºåç»­å‘ç”Ÿçš„è¯»æ“ä½œ")]),t._v(" "),s("li",[s("strong",[t._v("çº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼ˆThread Start Ruleï¼‰")]),t._v("ï¼šThreadå¯¹è±¡çš„start()æ–¹æ³•å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„æ²¡ä¸€ä¸ªåŠ¨ä½œ")]),t._v(" "),s("li",[s("strong",[t._v("çº¿ç¨‹ä¸­æ­¢è§„åˆ™ï¼ˆThread Termination Ruleï¼‰")]),t._v("ï¼šThreadå¯¹è±¡çš„ä¸­æ­¢æ£€æµ‹ï¼ˆå¦‚ï¼šThread.join()ï¼ŒThread.isAlive()ç­‰ï¼‰æ“ä½œï¼Œå¿…è¡Œæ™šäºçº¿ç¨‹ä¸­æ‰€æœ‰æ“ä½œ")]),t._v(" "),s("li",[s("strong",[t._v("çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼ˆThread Interruption Ruleï¼‰")]),t._v("ï¼šå¯¹çº¿ç¨‹çš„interruptionï¼ˆï¼‰è°ƒç”¨ï¼Œå…ˆäºè¢«è°ƒç”¨çš„çº¿ç¨‹æ£€æµ‹ä¸­æ–­äº‹ä»¶(Thread.interrupted())çš„å‘ç”Ÿ")]),t._v(" "),s("li",[s("strong",[t._v("å¯¹è±¡ä¸­æ­¢è§„åˆ™ï¼ˆFinalizer Ruleï¼‰")]),t._v("ï¼šä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–æ–¹æ³•å…ˆäºä¸€ä¸ªæ–¹æ³•æ‰§è¡ŒFinalizer()æ–¹æ³•\nä¼ é€’æ€§ï¼ˆTransitivityï¼‰ï¼šå¦‚æœæ“ä½œAå…ˆäºæ“ä½œBã€æ“ä½œBå…ˆäºæ“ä½œC,åˆ™æ“ä½œAå…ˆäºæ“ä½œC")])])]),t._v(" "),s("ul",[s("li",[s("ol",[s("li",[t._v("ç¨‹åºé¡ºåºè§„åˆ™(å•çº¿ç¨‹)")])]),t._v(" "),s("ul",[s("li",[t._v("åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰€æœ‰çš„å†™æ“ä½œå¯¹åç»­æ“ä½œå¯è§")])])]),t._v(" "),s("li",[s("ol",{attrs:{start:"2"}},[s("li",[t._v("é”è§„åˆ™(Sync,Lock)")])]),t._v(" "),s("ul",[s("li",[t._v("å¦‚æœçº¿ç¨‹Aè§£é”äº†Monitor,é‚£ä¹ˆåç»­è·å–é”çš„çº¿ç¨‹å¿…é¡»è¦å¯¹ä¹‹å‰çš„æ“ä½œå¯è§")])])]),t._v(" "),s("li",[s("ol",{attrs:{start:"3"}},[s("li",[t._v("volatileå˜é‡è§„åˆ™")])]),t._v(" "),s("ul",[s("li",[t._v("ä¸€ä¸ªå˜é‡å¦‚æœè¢«volatileæ‰€ä¿®é¥°,è¿™ä¸ªå˜é‡çš„æ‰€æœ‰å†™æ“ä½œéƒ½éœ€è¦å¯¹å…¶ä»–çº¿ç¨‹å¯è§(å¤šçº¿ç¨‹)")])])]),t._v(" "),s("li",[s("ol",{attrs:{start:"4"}},[s("li",[t._v("ä¼ é€’æ€§")])]),t._v(" "),s("ul",[s("li",[t._v("å¦‚æœA happens-before B, B happens-before C, é‚£ä¹ˆå¯ä»¥è®¤ä¸º A happens-before C")])])]),t._v(" "),s("li",[s("ol",{attrs:{start:"5"}},[s("li",[t._v("start() è§„åˆ™")])]),t._v(" "),s("ul",[s("li",[t._v("å¦‚æœAçº¿ç¨‹å¯åŠ¨äº†çº¿ç¨‹B,é‚£ä¹ˆAçº¿ç¨‹çš„å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹,å¯¹åº”å¯åŠ¨çš„çº¿ç¨‹Bå¯è§..(Bå¯åŠ¨åAçš„ä¿®æ”¹Bä¸ä¸€å®šå¯è§)")])])]),t._v(" "),s("li",[s("ol",{attrs:{start:"6"}},[s("li",[t._v("join() è§„åˆ™")])]),t._v(" "),s("ul",[s("li",[t._v("çº¿ç¨‹Aå†™å…¥çš„æ‰€æœ‰å˜é‡.åœ¨ä»»æ„å…¶ä»–çº¿ç¨‹Bè°ƒç”¨"),s("code",[t._v("A.join()")]),t._v(" æˆ–"),s("code",[t._v("A.isAlive()")]),t._v("æ—¶,éƒ½å¯¹Bå¯è§")])])])]),t._v(" "),s("h2",{attrs:{id:"_4-volatileåšäº†ä»€ä¹ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-volatileåšäº†ä»€ä¹ˆ"}},[t._v("#")]),t._v(" 4. volatileåšäº†ä»€ä¹ˆ?")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("åœ¨ä¸€ä¸ªå˜é‡è¢«volatileä¿®é¥°åï¼ŒJVMä¼šä¸ºæˆ‘ä»¬åšä¸¤ä»¶äº‹")]),t._v(" "),s("ul",[s("li",[t._v("1.åœ¨æ¯ä¸ªvolatileå†™æ“ä½œå‰æ’å…¥StoreStoreå±éšœï¼Œåœ¨å†™æ“ä½œåæ’å…¥StoreLoadå±éšœã€‚")]),t._v(" "),s("li",[t._v("2.åœ¨æ¯ä¸ªvolatileè¯»æ“ä½œå‰æ’å…¥LoadLoadå±éšœï¼Œåœ¨è¯»æ“ä½œåæ’å…¥LoadStoreå±éšœã€‚")])]),t._v(" "),s("p",[s("img",{attrs:{src:"http://md.yike.link/20200709223003_0EgYKC_Screenshot.jpeg",alt:"volatileåšäº†ä»€ä¹ˆ"}})])]),t._v(" "),s("h2",{attrs:{id:"_5-volatile-ä¸-synchronized-çš„åŒºåˆ«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-volatile-ä¸-synchronized-çš„åŒºåˆ«"}},[t._v("#")]),t._v(" 5. volatile ä¸ synchronized çš„åŒºåˆ«")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("åŒºåˆ«")]),t._v(" "),s("ul",[s("li",[t._v("volatile åªèƒ½ä¿®é¥°å˜é‡")]),t._v(" "),s("li",[t._v("volatile å¯ä»¥ç”¨äºç¦æ­¢æŒ‡ä»¤é‡æ’åº")]),t._v(" "),s("li",[t._v("synchronized å¯ä»¥ä¿®é¥°ä»£ç å—/æ–¹æ³•")]),t._v(" "),s("li",[t._v("volatileä¸ä¿è¯åŸå­æ€§,synchronizedä¿è¯åŸå­æ€§.. å¯¹äºä¸€ä¸ªå…±äº«å˜é‡çš„æ“ä½œ,å®Œå…¨å¯ä»¥ç”¨volatileæ›¿ä»£synchronized")]),t._v(" "),s("li")])]),t._v(" "),s("h2",{attrs:{id:"_6-å•åˆ©-volatile-ä¸­çš„åº”ç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-å•åˆ©-volatile-ä¸­çš„åº”ç”¨"}},[t._v("#")]),t._v(" 6. å•åˆ© volatile ä¸­çš„åº”ç”¨")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DclSingleton")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("volatile")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DclSingleton")]),t._v(" INSTANCE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DclSingleton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DclSingleton")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("INSTANCE "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*  å¦‚æœå˜é‡æ²¡åŠ volatile å¹¶å‘æƒ…å†µä¸‹å‡å¦‚æœ‰A,Bä¸¤ä¸ªçº¿ç¨‹åœ¨æ­¤ç­‰å¾…\n             * 1. Aå…ˆè·å–é”,å®Œæˆå®ä¾‹åˆ›å»º->é‡Šæ”¾é”\n             * 2.æ­¤æ—¶Bçº¿ç¨‹å¹¶ä¸å¯è§Açº¿ç¨‹çš„åˆ›å»ºçš„å¯¹è±¡,å¯¼è‡´å¯¹è±¡å†æ¬¡åˆ›å»º\n             * ä»¥ä¸Šæƒ…å†µå¯èƒ½ä¼šå‡ºç°å¤šä¾‹\n             */")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("synchronized")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DclSingleton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("INSTANCE "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    INSTANCE "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DclSingleton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" INSTANCE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-1-æœ€ä¼˜å•ä¾‹å†™æ³•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-æœ€ä¼˜å•ä¾‹å†™æ³•"}},[t._v("#")]),t._v(" 6.1. æœ€ä¼˜å•ä¾‹å†™æ³•")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * é™æ€å†…éƒ¨ç±»çš„å®ç°æ–¹å¼(æ‡’æ±‰å¼)\n *\n * ä¼˜ç‚¹:\n * 1.å¯ä»¥æ‡’åŠ è½½, åœ¨åŠ è½½å•åˆ©ç±»çš„æ—¶å€™å¹¶ä¸ä¼šåŠ è½½å…¶ä¸­çš„é™æ€å†…éƒ¨ç±»,åªæœ‰åœ¨getInstanceçš„æ—¶å€™æ‰ä¼šåŠ è½½\n * 2.ä¿è¯çº¿ç¨‹å®‰å…¨\n * 3.JMVä¿è¯å•åˆ©å”¯ä¸€æ€§\n *\n * @author Alex   2020/3/9 1:28 ä¸Šåˆ\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InnerClassSingleton")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InnerClassSingleton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InnerClassSingleton")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InnerClassSingletonHold")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("INSTANCE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InnerClassSingletonHold")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InnerClassSingleton")]),t._v(" INSTANCE "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InnerClassSingleton")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);