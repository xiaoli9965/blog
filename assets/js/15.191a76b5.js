(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{449:function(e,t,s){"use strict";s.r(t);var a=s(34),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"java-nio"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-nio"}},[e._v("#")]),e._v(" Java Nio")]),e._v(" "),s("p",[e._v("Java NIO根据系统环境不同,会有不同的实现")]),e._v(" "),s("h3",{attrs:{id:"selector-selector-open"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#selector-selector-open"}},[e._v("#")]),e._v(" selector = Selector.open()")]),e._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Selector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),s("p",[e._v("这个方法会判断系统环境选择使用 epoll还是 poll或select等...   "),s("strong",[e._v("优先使用epoll")])]),e._v(" "),s("p",[e._v("底层约等于调用了了 "),s("code",[e._v("epoll_create")])]),e._v(" "),s("h3",{attrs:{id:"server-register-selector-accpet"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-register-selector-accpet"}},[e._v("#")]),e._v(" server.register(selector, accpet)")]),e._v(" "),s("p",[e._v("如果底层是 epoll的话, 相当于调用了  epoll_ctr: ADD\n如果不是epoll, jvm内部开一个数组 吧fd放进去")]),e._v(" "),s("h3",{attrs:{id:"死循环-selector-select-timeout"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#死循环-selector-select-timeout"}},[e._v("#")]),e._v(" 死循环  selector.select(timeout)")]),e._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("while")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("selector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("select")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("timeout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),s("ul",[s("li",[e._v("如果是epoll相当于调用了  "),s("code",[e._v("epoll_awit(timeout)")])]),e._v(" "),s("li",[e._v("否则就是调用 "),s("code",[e._v("poll")]),e._v(" or "),s("code",[e._v("select")]),e._v(",   在内核中会遍历所有的fd")])]),e._v(" "),s("h3",{attrs:{id:"selector-selectorkeys"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#selector-selectorkeys"}},[e._v("#")]),e._v(" selector.selectorKeys()")]),e._v(" "),s("p",[e._v("这个代码就是epoll_awit之后获取到有事件的 fds了,然后后续逻辑可以进行逐一遍历和时间处理")])])}),[],!1,null,null,null);t.default=r.exports}}]);